let zLayer = 0
let list = [
img`
    .........ee.........
    ........eeee........
    ......eeeeeeee......
    .....eeeeeeeeee.....
    ....eeeeeeeeeeee....
    ..eeeeeeeeeeeeeeee..
    .eeeeeeeeeeeeeeeeee.
    eeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeee
    .eeeeeeeeeeeeeeeeee.
    ..eeeeeeeeeeeeeeee..
    ....eeeeeeeeeeee....
    .....eeeeeeeeee.....
    ......eeeeeeee......
    ........eeee........
    .........ee.........
    `,
img`
    .........ee.........
    ........eeee........
    ......eeeeeeee......
    .....eeeeeeeeee.....
    ....eeeeeeeeeeee....
    ..eeeeeeeeeeeeeeee..
    .eeeeeeeeeeeeeeeeee.
    eeeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeee
    .eeeeeeeeeeeeeeeeee.
    ..eeeeeeeeeeeeeeee..
    ....eeeeeeeeeeee....
    .....eeeeeeeeee.....
    ......eeeeeeee......
    ........eeee........
    .........ee.........
    `,
img`
    .........77.........
    ........7777........
    ......77777777......
    .....7777777777.....
    ....777777777777....
    ..7777777777777777..
    .777777777777777777.
    77777777777777777777
    77777777777777777777
    .777777777777777777.
    ..7777777777777777..
    ....777777777777....
    .....7777777777.....
    ......77777777......
    ........7777........
    .........77.........
    `,
img`
    .........ee.........
    ........eeee........
    ......eeeeeeee......
    .....eeeeeeeeee.....
    ....eeeeeeeeeeee....
    ..eeeeeeeeeeeeeeee..
    .eeeeeeeeeeeeeeee55.
    eeeeeeeeeeeeeeeee555
    eeeeeeeeeeeeeeee5555
    .eeeeeeeeeeeeee5555.
    ..eeeeeeeeeeee5555..
    ....eeeeeeeee555....
    .....eeeeeeee55.....
    ......eeeeee55......
    ........eee5........
    .........e5.........
    `,
img`
    .........55.........
    ........555e........
    ......5555eeee......
    .....555eeeeeee.....
    ....55eeeeeeeeee....
    ..555eeeeeeeeeeeee..
    .55eeeeeeeeeeeeeeee.
    5eeeeeeeeeeeeeeeeeee
    eeeeeeeeeeeeeeeeeeee
    .eeeeeeeeeeeeeeeeee.
    ..eeeeeeeeeeeeeeee..
    ....eeeeeeeeeeee....
    .....eeeeeeeeee.....
    ......eeeeeeee......
    ........eeee........
    .........ee.........
    `,
img`
    .........55.........
    ........5555........
    ......55555555......
    .....5555555555.....
    ....555555555555....
    ..5555555555555555..
    .555555555555555555.
    55555555555555555555
    55555555555555555555
    .555555555555555555.
    ..5555555555555555..
    ....555555555555....
    .....5555555555.....
    ......55555555......
    ........5555........
    .........55.........
    `
]
let tileMapImg = img`
    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 
    2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 
    2 2 5 1 2 2 2 2 2 2 2 1 2 2 2 2 
    2 2 4 1 2 2 2 1 2 2 2 1 2 2 2 2 
    2 2 2 3 1 2 2 1 1 2 2 1 2 2 2 2 
    2 2 2 5 2 2 2 1 2 1 1 2 2 2 2 2 
    2 2 2 2 2 2 2 2 1 1 1 2 2 2 2 2 
    2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 
    2 1 2 2 2 2 2 2 2 2 1 2 2 2 2 2 
    2 1 1 2 2 2 2 2 2 2 1 2 2 2 2 2 
    2 2 2 1 1 2 2 2 2 1 1 2 2 2 2 2 
    2 2 2 2 2 1 1 1 1 2 2 2 2 2 2 2 
    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 
    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 
    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 
    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 
    `
let mySprite = sprites.create(img`
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
    `, SpriteKind.Player)
controller.moveSprite(mySprite, 100, 100)
scene.cameraFollowSprite(mySprite)
mySprite.z = 100
let buf = Buffer.create(120)
let width = list[0].width
let height = list[0].height
let variable = scene.createRenderable(zLayer, (image: Image, camera: scene.Camera) => {
    if (mySprite.x <= -2) {
        mySprite.x = -2
    }
    if (mySprite.y <= 0) {
        mySprite.y = 0
    }
    if (mySprite.x >= tileMapImg.width * width - 2) {
        mySprite.x = tileMapImg.width * width - 2
    }
    if (mySprite.y >= tileMapImg.height * height / 2) {
        mySprite.y = tileMapImg.height * height / 2
    }
    for (let y1 = 0; y1 < tileMapImg.height; y1++) {
        if (y1 * height / 2 < camera.bottom + height && y1 * height / 2 > camera.top - height) {
            for (let x1 = 0; x1 < tileMapImg.width; x1++) {
                if (x1 * width < camera.right + height && x1 * width > camera.left - width) {
                    redrawImg.drawImg(x1 * width + (y1 /* + Math.round(camera.top / height) */) % 2 * width / 2 - width / 2 - camera.left, y1 * height / 2 - height / 2 - camera.top, list[tileMapImg.getPixel(x1 /* + camera.left / width */, y1 /* + Math.round(camera.top / height) */)], image)
                }
            }
        }
    }
    for (let index = 0; index < 160; index++) {
    }
})
namespace redrawImg {
    export function drawImg(x: number, y: number, startImg: Image, targetImg: Image) {
        for (let xIdx = 0; xIdx < width; xIdx++) {
            for (let yIdx = 0; yIdx < height; yIdx++) {
                if (startImg.getPixel(xIdx, yIdx) != 0) {
                    targetImg.setPixel(x + xIdx, y + yIdx, startImg.getPixel(xIdx, yIdx))
                }
            }
        }
    }
}
